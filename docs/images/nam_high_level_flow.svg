<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="820" viewBox="0 0 1200 820">
  <defs>
    <marker id="arrow" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#555" />
    </marker>
    <style><![CDATA[
      .box{fill:#fff;stroke:#444;stroke-width:2;rx:8;ry:8}
      .label{font:400 14px sans-serif; fill:#222}
      .title{font:700 18px sans-serif; fill:#222}
    ]]></style>
  </defs>

  <text class="title" x="40" y="40">NAM High-Level Flow</text>

  <rect class="box" x="40" y="80" width="360" height="60"/>
  <text class="label" x="60" y="115">Load inputs & overrides (IDF, modes, params)</text>

  <rect class="box" x="440" y="80" width="320" height="60"/>
  <text class="label" x="460" y="115">Load CN & isozones; align rasters</text>

  <rect class="box" x="800" y="80" width="320" height="60"/>
  <text class="label" x="820" y="115">Load DEM / time_values (as needed)</text>

  <line x1="400" y1="110" x2="440" y2="110" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="760" y1="110" x2="800" y2="110" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>

  <rect class="box" x="40" y="200" width="360" height="60"/>
  <text class="label" x="60" y="235">Apply readiness_to_drain to CN</text>

  <rect class="box" x="440" y="200" width="320" height="60"/>
  <text class="label" x="460" y="235">Compute S, Ia per cell</text>

  <rect class="box" x="800" y="200" width="320" height="60"/>
  <text class="label" x="820" y="235">Build storm (IDF; dt=10; 60 min)</text>

  <line x1="200" y1="140" x2="200" y2="200" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="600" y1="140" x2="600" y2="200" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="960" y1="140" x2="960" y2="200" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>

  <rect class="box" x="40" y="320" width="360" height="60"/>
  <text class="label" x="60" y="355">Choose center (storm_center_mode)</text>

  <rect class="box" x="440" y="320" width="320" height="60"/>
  <text class="label" x="460" y="355">Water balance → Pe per cell</text>

  <rect class="box" x="800" y="320" width="320" height="60"/>
  <text class="label" x="820" y="355">Compute travel time (routing)</text>

  <line x1="200" y1="260" x2="200" y2="320" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="600" y1="260" x2="600" y2="320" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="960" y1="260" x2="960" y2="320" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>

  <rect class="box" x="40" y="440" width="360" height="60"/>
  <text class="label" x="60" y="475">Sum volumes by arrival timestep</text>

  <rect class="box" x="440" y="440" width="320" height="60"/>
  <text class="label" x="460" y="475">Convert to discharge (m³/s)</text>

  <rect class="box" x="800" y="440" width="320" height="60"/>
  <text class="label" x="820" y="475">Compute HQ & diagnostics</text>

  <line x1="200" y1="380" x2="200" y2="440" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="600" y1="380" x2="600" y2="440" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="960" y1="380" x2="960" y2="440" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>
</svg>

