<svg xmlns="http://www.w3.org/2000/svg" width="1100" height="650" viewBox="0 0 1100 650">
  <defs>
    <marker id="arrow" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#555" />
    </marker>
    <style><![CDATA[
      .box{fill:#fff;stroke:#444;stroke-width:2;rx:8;ry:8}
      .title{font:700 16px sans-serif; fill:#222}
      .label{font:400 14px sans-serif; fill:#222}
      .group{fill:#f6f8fa;stroke:#bbb;stroke-width:2;rx:10;ry:10}
    ]]></style>
  </defs>

  <!-- Groups -->
  <rect class="group" x="40" y="40" width="280" height="560" />
  <text class="title" x="60" y="70">API</text>

  <rect class="group" x="380" y="40" width="300" height="560" />
  <text class="title" x="400" y="70">Celery Tasks</text>

  <rect class="group" x="720" y="40" width="340" height="560" />
  <text class="title" x="740" y="70">Data</text>

  <!-- API Routes -->
  <rect class="box" x="60" y="110" width="240" height="50"/><text class="label" x="80" y="140">GET /discharge/get_curve_numbers</text>
  <rect class="box" x="60" y="190" width="240" height="50"/><text class="label" x="80" y="220">GET /discharge/prepare_discharge_hydroparameters</text>
  <rect class="box" x="60" y="270" width="240" height="50"/><text class="label" x="80" y="300">GET /discharge/extract_dem</text>
  <rect class="box" x="60" y="350" width="240" height="50"/><text class="label" x="80" y="380">GET /discharge/nam</text>

  <!-- Tasks -->
  <rect class="box" x="400" y="110" width="260" height="50"/><text class="label" x="420" y="140">get_curve_numbers</text>
  <rect class="box" x="400" y="190" width="260" height="50"/><text class="label" x="420" y="220">prepare_discharge_hydroparameters</text>
  <rect class="box" x="400" y="270" width="260" height="50"/><text class="label" x="420" y="300">extract_dem</text>
  <rect class="box" x="400" y="350" width="260" height="50"/><text class="label" x="420" y="380">nam</text>

  <!-- Data inputs/outputs -->
  <rect class="box" x="740" y="110" width="300" height="50"/><text class="label" x="760" y="140">catchment_geojson (DB)</text>
  <rect class="box" x="740" y="170" width="300" height="50"/><text class="label" x="760" y="200">esa_worldcover_2021.vrt</text>
  <rect class="box" x="740" y="230" width="300" height="50"/><text class="label" x="760" y="260">HYSOGs250m.tif / ORNL WCS</text>
  <rect class="box" x="740" y="290" width="300" height="50"/><text class="label" x="760" y="320">geotiffminusriver.tif</text>
  <rect class="box" x="740" y="350" width="300" height="50"/><text class="label" x="760" y="380">curvenumbers.tif</text>
  <rect class="box" x="740" y="410" width="300" height="50"/><text class="label" x="760" y="440">isozones_cog.tif</text>
  <rect class="box" x="740" y="470" width="300" height="50"/><text class="label" x="760" y="500">time_values.tif</text>
  <rect class="box" x="740" y="530" width="300" height="50"/><text class="label" x="760" y="560">dem.tif</text>

  <!-- Connections -->
  <line x1="300" y1="135" x2="400" y2="135" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="300" y1="215" x2="400" y2="215" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="300" y1="295" x2="400" y2="295" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="300" y1="375" x2="400" y2="375" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Task to data -->
  <line x1="660" y1="135" x2="740" y2="135" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="660" y1="215" x2="740" y2="550" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="660" y1="215" x2="740" y2="430" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="660" y1="215" x2="740" y2="490" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="660" y1="295" x2="740" y2="310" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Inputs to curve numbers task -->
  <line x1="740" y1="135" x2="660" y2="135" stroke="#bbb" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="740" y1="200" x2="660" y2="135" stroke="#bbb" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="740" y1="260" x2="660" y2="135" stroke="#bbb" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Outputs from curve numbers and preprocessing to NAM -->
  <line x1="740" y1="375" x2="660" y2="375" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="740" y1="435" x2="660" y2="375" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="740" y1="495" x2="660" y2="375" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="740" y1="555" x2="660" y2="375" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>
</svg>

